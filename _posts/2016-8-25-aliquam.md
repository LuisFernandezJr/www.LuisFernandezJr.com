---
layout: post
title: 
description: 
image: 
---

<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"DengXian Light";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:"\@DengXian";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@DengXian Light";}
@font-face
	{font-family:"Franklin Gothic Book";
	panose-1:2 11 5 3 2 1 2 2 2 4;}
@font-face
	{font-family:"Montserrat Medium";
	panose-1:0 0 6 0 0 0 0 0 0 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	font-size:12.0pt;
	font-family:"Franklin Gothic Book",sans-serif;
	color:black;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Montserrat Medium";}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Montserrat Medium";
	color:#2F5496;
	font-weight:normal;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Calibri Light",sans-serif;
	color:#1F3763;
	font-weight:normal;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	font-size:11.0pt;
	font-family:"Franklin Gothic Book",sans-serif;
	font-weight:bold;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:10.0pt;
	font-size:12.0pt;
	font-family:"Franklin Gothic Book",sans-serif;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:20.15pt;
	font-size:11.0pt;
	font-family:"Franklin Gothic Book",sans-serif;}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:5.0pt;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Franklin Gothic Book",sans-serif;
	color:black;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0in;
	font-size:12.0pt;
	font-family:"Franklin Gothic Book",sans-serif;
	color:black;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0in;
	font-size:12.0pt;
	font-family:"Franklin Gothic Book",sans-serif;
	color:black;}
a:link, span.MsoHyperlink
	{color:#0563C1;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:#954F72;
	text-decoration:underline;}
p.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing
	{mso-style-link:"No Spacing Char";
	margin:0in;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Franklin Gothic Book",sans-serif;
	color:black;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Franklin Gothic Book",sans-serif;
	color:black;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Franklin Gothic Book",sans-serif;
	color:black;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	font-size:12.0pt;
	font-family:"Franklin Gothic Book",sans-serif;
	color:black;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Montserrat Medium";
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;
	font-family:"Franklin Gothic Book",sans-serif;
	color:black;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Franklin Gothic Book",sans-serif;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Montserrat Medium";
	color:#2F5496;}
span.NoSpacingChar
	{mso-style-name:"No Spacing Char";
	mso-style-link:"No Spacing";
	font-family:DengXian;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Calibri Light",sans-serif;
	color:#1F3763;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:107%;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US link="#0563C1" vlink="#954F72" style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-bottom:8.0pt;line-height:107%'><a
name="_Hlk149401118"></a><span style='font-family:"Montserrat Medium";
color:#004E76'>&nbsp;</span></p>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><img width=364 height=375
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image001.png"
alt="Icon&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal style='margin-bottom:8.0pt;line-height:107%'><span
style='font-family:"Montserrat Medium";color:#004E76'>&nbsp;</span></p>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><span style='font-size:26.0pt;line-height:107%;font-family:
"Montserrat Medium";color:#004E76'>Practical Malware Analysis &amp; Triage</span></p>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><span style='font-size:26.0pt;line-height:107%;font-family:
"Montserrat Medium";color:#004E76'>Malware Analysis Report</span></p>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><u><span style='font-size:22.0pt;line-height:107%;font-family:
"Montserrat Medium";color:#004E76'><span style='text-decoration:none'>&nbsp;</span></span></u></p>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><span style='font-size:22.0pt;line-height:107%;font-family:
"Montserrat Medium";color:#004E76'>WannaCry Ransomware Worm</span></p>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><span style='font-family:"Montserrat Medium";color:#004E76'>&nbsp;</span></p>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><span style='font-family:"Montserrat Medium";color:#004E76'>Oct
2023 | Luis Fernandez Jr. | v1.0</span></p>

<span style='font-size:12.0pt;line-height:107%;font-family:"Montserrat Medium";
color:#004E76'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-bottom:8.0pt;line-height:107%'><span
style='font-family:"Montserrat Medium";color:#004E76'>&nbsp;</span></p>

<h1><a name="_Toc149586266">Table of Contents</a></h1>

<p class=MsoToc1><a
href="#_Toc149586266">Table of Contents<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc1><a href="#_Toc149586267">Executive Summary<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc1><a href="#_Toc149586268">Malware Composition<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586269">ransomware.wannacry.exe<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586270">mssecsvc.exe<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586271">tasksche.exe<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc1><a href="#_Toc149586272">Basic Static Analysis<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586273">Analysis of Strings (FLOSS)<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586274">PeView &amp; PeStudio<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc1><a href="#_Toc149586275">Basic Dynamic Analysis<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586276">INETSIM: On (Killswitch Success)<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586277">INETSIM: Off (Killswitch
Unsuccessful)<span style='color:windowtext;display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc3><a href="#_Toc149586278">ProcMon<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc3><a href="#_Toc149586279">TCPView<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc1><a href="#_Toc149586280">Advanced Static Analysis<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586281">Cutter<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc1><a href="#_Toc149586282">Advanced Dynamic Analysis<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586283">x32dbg<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc1><a href="#_Toc149586284">Indicators of Compromise<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586285">Network Indicators<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586286">Host-based Indicators<span
style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc1><a href="#_Toc149586287">Appendices<span style='color:windowtext;
display:none;text-decoration:none'> </span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586288">A.<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;text-decoration:none'>       </span>Yara
Rules<span style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586289">B.<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;text-decoration:none'>       </span>Callback
URLs<span style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoToc2><a href="#_Toc149586290">C.<span style='font-size:11.0pt;
font-family:"Calibri",sans-serif;color:windowtext;text-decoration:none'>       </span>Hash
Signatures<span style='color:windowtext;display:none;text-decoration:none'></span><span
style='color:windowtext;display:none;text-decoration:none'></span></a></p>

<p class=MsoNormal><span style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<span style='font-size:12.0pt;line-height:107%;font-family:"Montserrat Medium";
color:black'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-bottom:8.0pt;line-height:107%'><span
style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<h1><a name="_Toc149586267">Executive Summary</a></h1>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>SHA256 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>24D004A104D4D54034DBCFFC2A4B19A11F39008A575AA614EA04703480B1022C</span></p>
  </td>
 </tr>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>SHA-1 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>e889544aff85ffaf8b0d0da705105dee7c97fe26</span></p>
  </td>
 </tr>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>MD5 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>db349b97c37d22f5ea1d1841e3c89eb4</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>WannaCry
is ransomware, which is a type of cryptographic self-propagating malicious
software, first publicly identified on May 12<sup>th</sup>, 2017. The WannaCry ransomware
propagates through the network, impacting computers running Microsoft Windows. Files
are encrypted and the impacted victims  are extorted for a BitCoin Ransom. </span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>WannaCry,
a x32 bit executable, is compiled in C++ and exploits a vulnerability in
Windows and the Server Message Block (SMBv1) protocol. There are multiple
stages to the WannaCry malware beginning with a dropper which unpacks a
malicious payload. During the execution of WannaCry, a ping to the “Killswitch”
URL is sent, upon successful ping, no further execution occurs. On the other
hand, an unsuccessful ping results in execution and infection. </span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>Signs
of infection are: </span></p>

<p class=MsoListParagraphCxSpFirst style='text-align:justify;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Montserrat Medium"'>“.WNCRY” appended
file extensions</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-align:justify;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Montserrat Medium"'>A new desktop
background displaying text</span></p>

<p class=MsoListParagraphCxSpMiddle style='text-align:justify;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Montserrat Medium"'>An executable with
a GUI for decryption and bitcoin address</span></p>

<p class=MsoListParagraphCxSpLast style='text-align:justify;text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Montserrat Medium"'>A ransom note
“.readme” file</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>Indicators,
YARA rules and signatures are attached in Appendix A. Malware sample and hashes
have been submitted to VirusTotal for further examination.</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<span style='font-size:12.0pt;line-height:107%;font-family:"Montserrat Medium";
color:black'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-bottom:8.0pt;line-height:107%'>High-Level
Technical Summary</p>

<p class=MsoNormal><b><span style='font-family:"Montserrat Medium"'>Phase 1</span></b><span
style='font-family:"Montserrat Medium"'>: The first phase consists of a dropper
attempting to reach out to the “Killswitch” URL.  </span></p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Montserrat Medium"'>If the attempt to
connect to the URL is successful, then the WannaCry malware halts and the
program is terminated. </span></p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-family:"Montserrat Medium"'>If the attempt to
connect to the URL is not successful, then the WannaCry Malware continues to encrypt
the system. <br>
<br>
</span></p>

<p class=MsoNormal><b><span style='font-family:"Montserrat Medium"'>Phase 2</span></b><span
style='font-family:"Montserrat Medium"'>: During the second phase, “tasksche.exe”
is extracted to infect and encrypt the hosts files. The malware creates and
runs a service to maintain persistence, scans local networks, and tries to
propagate to other victims.</span></p>

<p class=MsoNormal><span style='font-family:"Montserrat Medium"'>&nbsp;</span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='margin-bottom:8.0pt;line-height:107%'><img width=684
height=491 src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image002.png"
align=left hspace=12></p>

<span style='font-size:12.0pt;line-height:107%;font-family:"Franklin Gothic Book",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal style='margin-bottom:8.0pt;line-height:107%'><b><span
style='font-size:18.0pt;line-height:107%;font-family:"Montserrat Medium";
color:windowtext'>&nbsp;</span></b></p>

<h1><a name="_Toc149586268">Malware Composition</a></h1>

<p class=MsoNormal>WannaCry consists of the following components:</p>

<p class=MsoNormal>&nbsp;</p>

<table class=MsoTable15Grid4Accent1 border=1 cellspacing=0 cellpadding=0
 width=654 style='width:490.5pt;margin-left:-18.25pt;border-collapse:collapse;
 border:none'>
 <tr style='height:8.8pt'>
  <td width=174 valign=top style='width:130.2pt;border:solid #4472C4 1.0pt;
  border-right:none;background:#4472C4;padding:0in 5.4pt 0in 5.4pt;height:8.8pt'>
  <p class=MsoNormal align=center style='text-align:center'>File Name</p>
  </td>
  <td width=480 valign=top style='width:360.3pt;border:solid #4472C4 1.0pt;
  border-left:none;background:#4472C4;padding:0in 5.4pt 0in 5.4pt;height:8.8pt'>
  <p class=MsoNormal align=center style='text-align:center'>SHA256 Hash</p>
  </td>
 </tr>
 <tr style='height:17.75pt'>
  <td width=174 valign=top style='width:130.2pt;border:solid #8EAADB 1.0pt;
  border-top:none;background:#D9E2F3;padding:0in 5.4pt 0in 5.4pt;height:17.75pt'>
  <p class=MsoNormal><b><span style='font-size:10.0pt'>ransomware.wannacry.exe</span></b></p>
  </td>
  <td width=480 valign=top style='width:360.3pt;border-top:none;border-left:
  none;border-bottom:solid #8EAADB 1.0pt;border-right:solid #8EAADB 1.0pt;
  background:#D9E2F3;padding:0in 5.4pt 0in 5.4pt;height:17.75pt'>
  <p class=MsoNormal><span style='font-size:10.0pt;font-family:"Calibri",sans-serif'>24D004A104D4D54034DBCFFC2A4B19A11F39008A575AA614EA04703480B1022C</span></p>
  </td>
 </tr>
 <tr style='height:17.75pt'>
  <td width=174 valign=top style='width:130.2pt;border:solid #8EAADB 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt;height:17.75pt'>
  <p class=MsoNormal><b><span style='font-size:10.0pt'>tasksche.exe</span></b></p>
  </td>
  <td width=480 valign=top style='width:360.3pt;border-top:none;border-left:
  none;border-bottom:solid #8EAADB 1.0pt;border-right:solid #8EAADB 1.0pt;
  padding:0in 5.4pt 0in 5.4pt;height:17.75pt'>
  <p class=MsoNormal><span style='font-size:10.0pt;font-family:"Calibri",sans-serif'>ED01EBFBC9EB5BBEA545AF4D01BF5F1071661840480439C6E5BABE8E080E41AA</span></p>
  </td>
 </tr>
 <tr style='height:8.3pt'>
  <td width=174 valign=top style='width:130.2pt;border:solid #8EAADB 1.0pt;
  border-top:none;background:#D9E2F3;padding:0in 5.4pt 0in 5.4pt;height:8.3pt'>
  <p class=MsoNormal><a name="_Hlk149480316"><b><span style='font-size:10.0pt'>mssecsvc.exe</span></b></a></p>
  </td>
  <td width=480 valign=top style='width:360.3pt;border-top:none;border-left:
  none;border-bottom:solid #8EAADB 1.0pt;border-right:solid #8EAADB 1.0pt;
  background:#D9E2F3;padding:0in 5.4pt 0in 5.4pt;height:8.3pt'>
  <p class=MsoNormal><span style='font-size:10.0pt;font-family:"Calibri",sans-serif'>F8812F1DEB8001F3B7672B6FC85640ECB123BC2304B563728E6235CCBE782D85</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc149586269">ransomware.wannacry.exe</a></h2>

<p class=MsoNormal>Originally named in this analysis as “lhdfrgui.exe” The
initial phase of the executable is utilized to detect if the Killswitch URL is
accessible. If the Killswitch URL is successful the malware does not execute; otherwise,
if the Killswitch URL is not detected, the remaining steps are unpacked. </p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc149586270">mssecsvc.exe</a></h2>

<p class=MsoNormal style='margin-bottom:8.0pt;line-height:107%'>Service created
to exploit an SMB vulnerability and maintain persistence on the host. </p>

<h2><a name="_Toc149586271"><span class=Heading2Char>tasksche.exe</span></a> </h2>

<p class=MsoNormal>A resource extracted to maintain persistence and proceeds to
encrypt the host system. A random folder name in ProgramData is created to
stage ransomware and further infect systems.  </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'>&nbsp;</p>

<i><span style='font-size:12.0pt;line-height:107%;font-family:"Franklin Gothic Book",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span></i>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><i>&nbsp;</i></p>

<h1><a name="_Toc149586272">Basic Static Analysis</a></h1>

<h2><a name="_Toc149586273"><u>Analysis of Strings (FLOSS)</u></a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal style='text-align:justify'><span style='font-family:"Montserrat Medium"'>The
static analysis below is a representation of the strings extracted from the
executable utilizing <b>FLOSS</b>.  The figures below are examples of extracted
strings, and utilization of grep pattern match across specific search criteria.
Results show readable strings matching on characters higher than 8. </span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=407
height=95 src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image003.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig 1: Floss tool matching
on at least 8 characters in the file.</i></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=421
height=163 id="Picture 4"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image004.png"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig 2: Cryptographic
DLLs the binary uses for encryption.</i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal align=center style='text-align:center'><img width=418
height=117 id="Picture 9"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image005.png"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig 3: Task
Scheduler, Process Creation, and Killswitch URL.</i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=417
height=108 src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image006.png"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig 4: Applied DACLs,
Hidden File Attribution, and password. </i></p>

<h2><a name="_Toc149586274"><u>PeView &amp; PeStudio</u></a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><span style='font-family:"Montserrat Medium"'>Assessing the
executable through PeView and PeStudio provides header information, size,
hashes, indicators, and bytes. The compiler stamp is shown as Sat, Nov 20<sup>th</sup>
09:03:08 2010 UTC. An area to check is the .rdata section. Additional files or
executables are hidden and can be found in the resource section which are later
used as part of malwares design. </span></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=567
height=216 id="Picture 6"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image007.png"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 5: Analyzing
the size and .rdata sections determine packed malware.</i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal><span style='font-family:"Montserrat Medium"'>Focusing on
the resources section (.rsrc) of the file we can see a record labeled R 1831
with a high entropy score, suspicious size, and the magic bytes (4D 5A)
referring to an executable. In this malware sample, the hard coded string found
“WNcry@20l7” is used to extract the resource identified. </span></p>

<p class=MsoNormal align=center style='text-align:center'><i><img width=566
height=217 src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image008.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></i></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 6: Highlighting
identifiers in the resource sections of the executable. </i></p>

<p class=MsoNormal align=center style='text-align:center'><i><span
style='font-size:11.0pt;font-family:"Calibri",sans-serif'>&nbsp;</span></i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal><span style='font-family:"Montserrat Medium"'>PeStudio
provides us a look at the import address table (IAT) with information on the
executable. By default, these imports are not malicious, but they infer the
malware attempts to file creation, execution, and other tactics or techniques.
The indicator strings also matches url previously identified during our FLOSS
workflow. </span></p>

<p class=MsoNormal align=center style='text-align:center'><img width=634
height=345 src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image009.png"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 7: Highlights
from the IAT Table and the indicators section.</i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal align=center style='text-align:center'><img width=480
height=289 src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image010.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 8: General
overview of Hashes, Bytes, original filename, and description. </i></p>

<b><span style='font-size:18.0pt;font-family:"Montserrat Medium"'><br
clear=all style='page-break-before:always'>
</span></b>

<h1><a name="_Toc149586275">Basic Dynamic Analysis</a></h1>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc149586276"><u>INETSIM: On (Killswitch Success)</u></a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The malware behaves differently when our INETSIM configured
correctly. INETSIM provides a simulated successful response in our lab. We can
also capture traffic requests in REMnux.  </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Setting up INETSIM and a Wireshark capture provides evidence
of a host with the dropper attempting to reach any URLs. The HTTP GET request
is resolved which get registered to the program. After knowing that the
connection is successful the malware comes to a halt.  </p>

<p class=MsoNormal align=center style='text-align:center'><img width=399
height=250 id="Picture 13"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image011.png"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 9: REMnux
utilizing INETSIM and WireShark capture.</i></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=370
height=284 id="Picture 16"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image012.png"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 10: WireShark
Network capture displaying the Killswitch URL.</i></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<h2><a name="_Toc149586277"><u>INETSIM: Off (Killswitch Unsuccessful)</u></a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>When the malware is running without INETSIM (without the
internet), and if the executable is running with <b><u>administrative
privileges</u></b>, the files on the local endpoint will get encrypted.
Noticeable symptoms will depict a wallpaper, forensic artifact file
(cosmo.jpeg) is no longer usable, files will have a WNCRY extension appended,
and a new executable called @WannaDecryptor@.exe is added to the desktop. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b><span style='font-size:18.0pt;font-family:"Montserrat Medium";
color:windowtext'>&nbsp;</span></b></p>

<p class=MsoNormal align=center style='text-align:center'><b><span
style='font-size:18.0pt;font-family:"Montserrat Medium";color:windowtext'><img
width=136 height=138
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image013.png"
alt="A cat sitting next to pumpkins&#10;&#10;Description automatically generated"></span></b>  
<img width=355 height=140
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image014.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 11: Files
appearing on the desktop and jpeg artifact modification.</i></p>

<p class=MsoNormal><b><span style='font-size:18.0pt;font-family:"Montserrat Medium";
color:windowtext'>&nbsp;</span></b></p>

<p class=MsoNormal>An infected system will display a window with a countdown
clock, instructions to pay a ransom amount, and a bitcoin address to pay the
criminals in order to decrypt their files. A new background and decryptor
executable will be persistently popping up along with a BitCoin Address: 12t9YDPgwueZ9NyMgw519p7AA8isjr6SMw
for payment. </p>

<p class=MsoNormal><b><span style='font-size:18.0pt;font-family:"Montserrat Medium";
color:windowtext'>&nbsp;</span></b></p>

<p class=MsoNormal align=center style='text-align:center'><span
style='font-family:"Montserrat Medium"'><img width=478 height=228
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image015.png"
alt="A computer screen shot of a computer&#10;&#10;Description automatically generated"></span></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 12: An infected
system with WannaCry. </i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal><b><span style='font-size:18.0pt;font-family:"Montserrat Medium";
color:windowtext'>&nbsp;</span></b></p>

<h3><a name="_Toc149586278"><u><span style='font-size:14.0pt'>ProcMon</span></u></a></h3>

<p class=MsoNormal>Executing the Procmon tool can capture a lot of noise. Getting
familiar with processes is key to see specific activity and scenarios. Inclusions
and/or exclusions highlight relevant events. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=503
height=304 id="Picture 2"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image016.png"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 13: ProcMon
filters for “Operation” with “CreateFile” value and “ProcessName” with
“Ransomware.wannacry.exe”.</i></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal>Notice that the “Ransomware.wannacry.exe” created various
processes. We can identify the tasksche.exe along with it’s process ID as part
of the events.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=495
height=270 id="Picture 3"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image017.png"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 14: Results
of filter and discovering “tasksche.exe”.</i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal>From the identified process (tasksche.exe) we can pivot to
the Process Tree and target the process or parent process IDs involved. Additionally,
applying new filters in ProcMon such as process ID’s, parent process ID’s,
registry changes or additions can lead us to new events.  </p>

<p class=MsoNormal align=center style='text-align:center'><img width=343
height=289 src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image018.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 15: Process tree
depicting path, PID and PPIDs. </i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal>Searching for files created and process IDs a “hidden”
folder in C:\Programdata can be found. This folder is associated to the“attrib
+h” commands found in the strings analysis. There is a service with the same
name “mxfzsyvkto014” as the hidden folder created.</p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal align=center style='text-align:center'><img width=318
height=245 src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image019.png"><img
width=291 height=243
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image020.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 16: Location
of hidden resources revealed and attribution to Services.</i></p>

<h3><a name="_Toc149586279"><u><span style='font-size:14.0pt'>TCPView</span></u></a></h3>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>From TCPView we can see a flood of connections to port 445,
which is utilized by the SMB protocol, targeting variety of addresses through
mssecsvc2.0. <i><br>
</i><b><span style='font-size:18.0pt;font-family:"Montserrat Medium";
color:windowtext'><img width=643 height=135
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image021.png"></span></b></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 17: TCPview
capturing the binary sending requests.</i></p>

<h1><a name="_Toc149586280">Advanced Static Analysis</a></h1>

<h2><a name="_Toc149586281"><u>Cutter</u></a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Using Cutter, advanced static analysis is conducted to
glance at meta-data which is useful to understand how the binary works. With an
understanding that the malware checks for the Killswitch URL, we can look at
the main function. The main function typically is the starting point of
execution and gives more insight on program execution.  </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><img width=441 height=345 id="Picture 14"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image022.png"><img
width=169 height=101
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image023.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 18 &amp; 19: Overview
of Cutter followed by loading into the main function. </i></p>

<p class=MsoNormal align=center style='text-align:center'><i>&nbsp;</i></p>

<p class=MsoNormal>Opening the main function in the graph view exposes the low-level
assembly code and the highlighted Internet APIs: InternetOpenA,
InternetOpenUrlA, and InternetCloseHandle. These APIs were noted during the
analysis in PeStudio. InternetOpenUrlA is known to open a specified resource and
store the value, which is later used in the stack.   </p>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><b><span style='font-size:18.0pt;line-height:107%;font-family:
"Montserrat Medium";color:windowtext'><img width=275 height=347 id="Picture 15"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image024.png"></span></b><i><br>
Fig. 20: Graph view of main function.</i></p>

<p class=MsoNormal>Towards the bottom of the main function is a test
instruction that performs a bitwise AND on two operands (edi and edi). There is
a flag, aka the Zero Flag or ZF which is set  to 1 or 0. The ZF value is set to
1 (seen later). Right after test, is a JNE “Jump if not equal” condition.</p>

<p class=MsoListParagraphCxSpFirst style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>When the test of edi against edi is performed, if the results of
the test set the ZF value to 0, the program moves to address 0x4081BC which
results in exiting the program.  (Successful Connection)</p>

<p class=MsoListParagraphCxSpLast style='text-indent:-.25in'><span
style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>If the results of the test are 1 the program proceeds and jumps
to 0x004081a7 address resulting in the continuation of the malware.
(Unsuccessful Connection)</p>

<p class=MsoNormal align=center style='text-align:center'><i><img width=424
height=153 id="Picture 12"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image025.jpg"></i></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 21: Killswitch
assembly code focus on TEST and JNE instruction.</i></p>

<h1><a name="_Toc149586282">Advanced Dynamic Analysis</a></h1>

<h2><a name="_Toc149586283"><u>x32dbg</u></a></h2>

<p class=MsoNormal>Opening this malware sample in x64dbg says “use x32dbg to
debug this file”. It’s worth noting that the architecture of this sample is x86
as detected by Cutter and other tools. </p>

<p class=MsoNormal align=center style='text-align:center'><img width=304
height=51 src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image026.png"></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 22: x64dbg
prompting to use x32dbg.</i></p>

<p class=MsoNormal align=center style='text-align:center'>&nbsp;</p>

<p class=MsoNormal>By opening the malware sample in x32dbg we have more control
over the code instructions. Opening the malware sample successfully, highlights
a lot of information. Immediately, the EIP is pointing to next step of assembly
instructions. The ZF value is seen to be set to 1, which can change throughout
the program’s instructions. Given our current conditions of the host, we will
manipulate the ZF value to try and prevent the program from running further.
Otherwise, when the ZF value is set to 1, the conditional jump execution will
infect the host. </p>

<p class=MsoNormal align=center style='text-align:center'><i><img width=584
height=173 id="Picture 8"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image027.png"></i></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 23:
Instruction pointer and the Zero Flag set to 1. </i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal>The infamous URL is continuously seen during analysis so we
can use strings built into x32dbg and find the value yet again. The difference
in this scenario is setting a breakpoint on the address found and stepping into
each set of instructions to observe changes. </p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal align=center style='text-align:center'><i><img width=439
height=128 src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image028.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"></i></p>

<p class=MsoNormal align=center style='text-align:center'><i>Fig. 24: Setting a
breakpoint on the address <a name="_Hlk149580262">0x0040814A</a></i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal>Working with x32dbg, REMnux is not on running, which means
INETSIM is off and a failed or unsuccessful connection to the URL would occur,
leading to infection on the host. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Setting the breakpoint on the address 0x0040814A, allows us
to step and pause into each instruction, following up to the internet API
calls. Note that the EDI value stored is 0, which indicates nothing was
returned when the internet APIs reach out to the suspicious URL. The ZF value
is set to 1, and if the JNE instruction is called while ZF value is set to 1, a
jump to address 0x0040817 occurs, followed by another function leading to infect
the host. </p>

<p class=MsoNormal align=center style='text-align:center'><i><img width=517
height=266 id="Picture 10"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image029.png"><br>
Fig. 25: Setting a breakpoint on the address 0x0040814A</i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<p class=MsoNormal>On address 0x004081A5 where the JNE instruction occurs, we
can interfere which the programs logic. By double clicking on the ZF value, the
value is set to 0, altering the conditions and halting the program. </p>

<p class=MsoNormal align=center style='text-align:center'><i><img width=151
height=69 id="Picture 11"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image030.png"><br>
Fig. 26: Changing the ZF value from 1 to 0. </i></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>When stepping into the next instruction, we are brought to
the memory address known as 0x4081BC. Continuing down this path will proceed to
terminate and exit the program. No infection occurs.  </p>

<p class=MsoNormal align=center style='text-align:center'><i><img width=374
height=93 id="Picture 1"
src="https://github.com/LuisFernandezJr/www.LuisFernandezJr.com/blob/master/_posts/image031.png"
alt="A screenshot of a computer&#10;&#10;Description automatically generated"><br>
Fig. 27: Changing the ZF value leads to 0x4081BC address. </i></p>

<p class=MsoNormal><i>&nbsp;</i></p>

<h1><a name="_Toc149586284">Indicators of Compromise</a></h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The following are samples of indicators observed on an
infected host. </p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc149586285">Network Indicators</a></h2>

<p class=MsoNormal>hxxp://www[.]iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com</p>

<p class=MsoNormal style='margin-bottom:8.0pt;line-height:107%'>&nbsp;</p>

<h2><a name="_Toc149586286">Host-based Indicators</a></h2>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b>FilePath:</b></p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>%ProgramData%\&lt;random directory name&gt;\tasksche.exe</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal><b>Files created:</b></p>

<p class=MsoNormal>00000000.eky</p>

<p class=MsoNormal>00000000.pky</p>

<p class=MsoNormal>00000000.res</p>

<p class=MsoNormal>@Please_Read_Me@.txt</p>

<p class=MsoNormal>@WanaDecryptor@.exe</p>

<p class=MsoNormal>b.wnry</p>

<p class=MsoNormal>c.wnry</p>

<p class=MsoNormal>f.wnry</p>

<p class=MsoNormal>r.wnry</p>

<p class=MsoNormal>s.wnry</p>

<p class=MsoNormal>t.wnry</p>

<p class=MsoNormal>taskdl.exe</p>

<p class=MsoNormal>taskse.exe</p>

<p class=MsoNormal>u.wnry</p>

<p class=MsoNormal>@WanaDecryptor@.bmp</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>Registry:</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>HKLM\SOFTWARE\Wow6432Node\WanaCrypt0r\wd</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<span style='font-size:12.0pt;line-height:107%;font-family:"Franklin Gothic Book",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal align=center style='margin-bottom:8.0pt;text-align:center;
line-height:107%'><b><span style='font-size:18.0pt;line-height:107%;font-family:
"Montserrat Medium";color:windowtext'>&nbsp;</span></b></p>

<h1><a name="_Toc149586287">Appendices</a></h1>

<h2 style='margin-left:.5in;text-indent:-.25in'><a name="_Toc149586288">A.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Yara Rules</a></h2>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#FF79C6'>rule</span><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'> Yara_wannacry_ransomware_custom
{</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp; </span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp; </span><span
style='font-size:10.5pt;font-family:Consolas;color:#FF79C6'>meta</span><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>: </span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; last_updated = </span><span style='font-size:10.5pt;font-family:
Consolas;color:#F1FA8C'>&quot;2023-10-02&quot;</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; author = </span><span style='font-size:10.5pt;font-family:Consolas;
color:#F1FA8C'>&quot;LF – Malware Analysis&quot;</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; description = </span><span style='font-size:10.5pt;font-family:
Consolas;color:#F1FA8C'>&quot; Basic Detection of WannaCry Ransomware on
endpoint disk&quot;</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp;</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp; </span><span
style='font-size:10.5pt;font-family:Consolas;color:#FF79C6'>strings</span><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>:</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; </span><span style='font-size:10.5pt;font-family:Consolas;
color:#6272A4'>// Strings in WannaCry</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; </span><i><span style='font-size:10.5pt;font-family:Consolas;
color:#FFB86C'>$string1</span></i><span style='font-size:10.5pt;font-family:
Consolas;color:#F8F8F2'> = </span><span style='font-size:10.5pt;font-family:
Consolas;color:#F1FA8C'>&quot;iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea&quot;&quot;</span><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'> </span><span
style='font-size:10.5pt;font-family:Consolas;color:#FF79C6'>ascii</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; </span><i><span style='font-size:10.5pt;font-family:Consolas;
color:#FFB86C'>$string2</span></i><span style='font-size:10.5pt;font-family:
Consolas;color:#F8F8F2'> = </span><span style='font-size:10.5pt;font-family:
Consolas;color:#F1FA8C'>&quot;icacls . /grant Everyone:F /T /C /Q&quot; </span><span
style='font-size:10.5pt;font-family:Consolas;color:#FF79C6'>fullword ascii</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; </span><i><span style='font-size:10.5pt;font-family:Consolas;
color:#FFB86C'>$string3</span></i><span style='font-size:10.5pt;font-family:
Consolas;color:#F8F8F2'> = </span><span style='font-size:10.5pt;font-family:
Consolas;color:#F1FA8C'>&quot;WANNACRY&quot; </span><span style='font-size:
10.5pt;font-family:Consolas;color:#FF79C6'>ascii</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; </span><i><span style='font-size:10.5pt;font-family:Consolas;
color:#FFB86C'>$string3</span></i><span style='font-size:10.5pt;font-family:
Consolas;color:#F8F8F2'> = &quot;</span><span style='font-size:10.5pt;
font-family:Consolas;color:#F1FA8C'>WNcry@2ol7&quot; </span><span
style='font-size:10.5pt;font-family:Consolas;color:#FF79C6'>ascii</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; </span><span style='font-size:10.5pt;font-family:Consolas;
color:#6272A4'>// Strings in WannaCry</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; </span><i><span style='font-size:10.5pt;font-family:Consolas;
color:#FFB86C'>$PE_magic_byte</span></i><span style='font-size:10.5pt;
font-family:Consolas;color:#F8F8F2'> = </span><span style='font-size:10.5pt;
font-family:Consolas;color:#F1FA8C'>&quot;MZ&quot;</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp;</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp; </span><span
style='font-size:10.5pt;font-family:Consolas;color:#FF79C6'>condition</span><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>:</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; </span><span style='font-size:10.5pt;font-family:Consolas;
color:#6272A4'>// Conditions that must be met to identify the binary</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; </span><i><span style='font-size:10.5pt;font-family:Consolas;
color:#FFB86C'>$PE_magic_byte</span></i><span style='font-size:10.5pt;
font-family:Consolas;color:#F8F8F2'> </span><span style='font-size:10.5pt;
font-family:Consolas;color:#FF79C6'>at</span><span style='font-size:10.5pt;
font-family:Consolas;color:#F8F8F2'> </span><span style='font-size:10.5pt;
font-family:Consolas;color:#BD93F9'>0</span><span style='font-size:10.5pt;
font-family:Consolas;color:#F8F8F2'> </span><span style='font-size:10.5pt;
font-family:Consolas;color:#FF79C6'>and</span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>&nbsp; &nbsp;
&nbsp; &nbsp; any of ($string*)&nbsp; &nbsp; &nbsp; &nbsp; </span></p>

<p class=MsoNormal style='line-height:14.25pt;background:#282A36'><span
style='font-size:10.5pt;font-family:Consolas;color:#F8F8F2'>}</span></p>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:.5in;text-indent:-.25in'><a name="_Toc149586289">B.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Callback URLs</a></h2>

<table class=MsoTable15Grid4Accent5 border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid #5B9BD5 1.0pt;
  border-right:none;background:#5B9BD5;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b>Domain</b></p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border:solid #5B9BD5 1.0pt;
  border-left:none;background:#5B9BD5;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal align=center style='text-align:center'><b>Port</b></p>
  </td>
 </tr>
 <tr>
  <td width=312 valign=top style='width:233.75pt;border:solid #9CC2E5 1.0pt;
  border-top:none;background:#DEEAF6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>hxxp[:]//]iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea[.]com</b></p>
  </td>
  <td width=312 valign=top style='width:233.75pt;border-top:none;border-left:
  none;border-bottom:solid #9CC2E5 1.0pt;border-right:solid #9CC2E5 1.0pt;
  background:#DEEAF6;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>80</p>
  </td>
 </tr>
</table>

<p class=MsoNormal>&nbsp;</p>

<h2 style='margin-left:.5in;text-indent:-.25in'><a name="_Toc149586290">C.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Hash Signatures</a></h2>

<p class=MsoNormal>ransomware.wannacry.exe</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>SHA256 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>24D004A104D4D54034DBCFFC2A4B19A11F39008A575AA614EA04703480B1022C</span></p>
  </td>
 </tr>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>SHA-1 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>e889544aff85ffaf8b0d0da705105dee7c97fe26</span></p>
  </td>
 </tr>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>MD5 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>db349b97c37d22f5ea1d1841e3c89eb4</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>tasksche.exe</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>SHA256 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>ED01EBFBC9EB5BBEA545AF4D01BF5F1071661840480439C6E5BABE8E080E41AA</span></p>
  </td>
 </tr>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>SHA-1 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>5FF465AFAABCBF0150D1A3AB2C2E74F3A4426467</span></p>
  </td>
 </tr>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>MD5 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>84C82835A5D21BBCF75A61706D8AB549</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal>mssecsvc.exe</p>

<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none'>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>SHA256 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>F8812F1DEB8001F3B7672B6FC85640ECB123BC2304B563728E6235CCBE782D85</span></p>
  </td>
 </tr>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>SHA-1 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>51E4307093F8CA8854359C0AC882DDCA427A813C</span></p>
  </td>
 </tr>
 <tr>
  <td width=102 valign=top style='width:76.25pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>MD5 hash</span></p>
  </td>
  <td width=522 valign=top style='width:391.25pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal style='text-align:justify'><span style='font-size:9.0pt;
  font-family:"Montserrat Medium"'>F107A717F76F4F910AE9CB4DC5290594</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><i>&nbsp;</i></p>

</div>

</body>

</html>

